
dsp.appraisalOrigin = 
{
    -- Leujaoam Sanctum
    ASSAULT_01 = 1, ASSAULT_02 = 2, ASSAULT_03 = 3, ASSAULT_04 = 4, ASSAULT_05 = 5, 
    ASSAULT_06 = 6, ASSAULT_07 = 7, ASSAULT_08 = 8, ASSAULT_09 = 9, ASSAULT_10 = 10,
    -- Mamool Ja Training Grounds
    ASSAULT_11 = 11, ASSAULT_12 = 12, ASSAULT_13 = 13, ASSAULT_14 = 14, ASSAULT_15 = 15,
    ASSAULT_16 = 16, ASSAULT_17 = 17, ASSAULT_18 = 18, ASSAULT_19 = 19, ASSAULT_20 = 20,
    -- Lebros Cavern
    ASSAULT_21 = 21, ASSAULT_22 = 22, ASSAULT_23 = 23, ASSAULT_24 = 24, ASSAULT_25 = 25,
    ASSAULT_26 = 26, ASSAULT_27 = 27, ASSAULT_28 = 28, ASSAULT_29 = 29, ASSAULT_30 = 30,
    -- Periqia
    ASSAULT_31 = 31, ASSAULT_32 = 32, ASSAULT_33 = 33, ASSAULT_34 = 34, ASSAULT_35 = 35,
    ASSAULT_36 = 36, ASSAULT_37 = 37, ASSAULT_38 = 38, ASSAULT_39 = 39, ASSAULT_40 = 40,
    -- Ilrusi Atoll
    ASSAULT_41 = 41, ASSAULT_42 = 42, ASSAULT_43 = 43, ASSAULT_44 = 44, ASSAULT_45 = 45,
    ASSAULT_46 = 46, ASSAULT_47 = 47, ASSAULT_48 = 48, ASSAULT_49 = 49, ASSAULT_50 = 50,

    -- Nyzul Isle Notorious Monsters
    -- Basic Item: ??? Ingot (2283), ??? Potion (2284), ??? Cloth (2285), ??? Box (2286)
    NYZUL_BASIC                 = 100,
    -- ??? Sword        2190
    NYZUL_AMIKIRI               = 101, 
    NYZUL_CARGO_CRAB_COLIN      = 102, 
    NYZUL_CARNERO               = 103, 
    NYZUL_EMERGENT_ELM          = 104,
    NYZUL_FROSTMANE             = 105, 
    NYZUL_KEEPER_OF_HALIDOM     = 106, 
    NYZUL_ZIZZY_ZILLAH          = 107,
    -- ??? Dagger       2191
    NYZUL_DAGGERCLAW_DRACOS     = 108, 
    NYZUL_MISCHIEVOUS_MICHOLAS  = 109, 
    NYZUL_NIGHTMARE_VASE        = 110, 
    NYZUL_ORCTRAP               = 111,
    NYZUL_SABOTENDER_MARIACHI   = 112, 
    NYZUL_STINGING_SOPHIE       = 113, 
    NYZUL_TOM_TIT_TAT           = 114, 
    NYZUL_WESTERN_SHADOW        = 115,
    -- ??? Polearm      2192
    NYZUL_FALCATUS_ARANEI       = 116, 
    NYZUL_HELLION               = 117, 
    NYZUL_JUGGLER_HECATOMB      = 118, 
    NYZUL_NUNYENUNC             = 119,
    NYZUL_ROC                   = 120, 
    NYZUL_SWAMFISK              = 121, 
    NYZUL_VOUIVRE               = 122,
    -- ??? Axe          2193
    NYZUL_BAT_EYE               = 123,
    NYZUL_AQUARIUS              = 124,
    NYZUL_NORTHERN_SHADOW       = 125, 
    NYZUL_TRICKSTER_KINETIX     = 126,
    NYZUL_TYRANNIC_TUNNOK       = 127,
    NYZUL_PANZER_PERCIVAL       = 128,
    NYZUL_PEG_POWLER            = 129,
    -- ??? Bow          2194
    NYZUL_GYRE_CARLIN           = 130, 
    NYZUL_UNGUR                 = 131, 
    NYZUL_EASTERN_SHADOW        = 132,
    NYZUL_HELLDIVER             = 133,
    -- ??? Gloves       2195
    NYZUL_PEALLAIDH             = 134,
    NYZUL_ENERGETIC_ERUCA       = 135,
    -- ??? Footwear     2196
    NYZUL_LEAPING_LIZZY         = 136, 
    NYZUL_CACTUAR_CANTAUTOR     = 137, 
    NYZUL_SIMURGH               = 138,
    NYZUL_BONNACON              = 139,
    NYZUL_TOTTERING_TOBY        = 140,
    -- ??? Headpiece    2276
    NYZUL_TAISAIJIN             = 141, 
    NYZUL_VALKURM_EMPEROR       = 142,
    NYZUL_ELLYLLON              = 143,
    NYZUL_DROOLING_DAISY        = 144,
    NYZUL_SHARP_EARED_ROPIPI    = 145,
    NYZUL_TUMBLING_TRUFFLE      = 146,
    -- ??? Earring      2277
    NYZUL_LEECH_KING            = 147,
    NYZUL_CAPRICIOUS_CASSIE     = 148,
    NYZUL_MAIGHDEAN_UAINE       = 149,
    -- ??? Ring         2278
    NYZUL_SMOTHERING_SCHMIDT    = 150, 
    NYZUL_ASPHYXIATED_AMSEL     = 151, 
    NYZUL_CRUSHED_KRAUSE        = 152,
    NYZUL_PULVERIZED_PFEFFER    = 153,
    NYZUL_BURNED_BERGMANN       = 154,
    NYZUL_WOUNDED_WURFEL        = 155,
    NYZUL_BLOODSUCKER           = 156, 
    NYZUL_SERKET                = 157, 
    NYZUL_SEWER_SYRUP           = 158,
    NYZUL_BOMB_KING             = 159,
    -- ??? Cape         2279
    NYZUL_OLD_TWO_WINGS         = 160, 
    NYZUL_FRAELISSA             = 161,
    NYZUL_SPINY_SPIPI           = 162,
    NYZUL_GOLDEN_BAT            = 163,
    -- ??? Sash         2280
    NYZUL_JOLLY_GREEN           = 164,
    -- ??? Shield       2281
    NYZUL_SOUTHERN_SHADOW       = 165, 
    NYZUL_BLOODTEAR_BALDURF     = 166, 
    NYZUL_STEELFLEECE_BALDARICH = 167,
    NYZUL_FUNGUS_BEETLE         = 168,
    NYZUL_PELICAN               = 169,
    -- ??? Necklace     2282
    NYZUL_SHADOW_EYE            = 170, 
    NYZUL_JAGGEDY_EARED_JACK    = 171, 
    NYZUL_ARGUS                 = 172, 
    NYZUL_GARGANTUA             = 173,
    NYZUL_SERPOPARD_ISHTAR      = 174,
    NYZUL_BLOODPOOL_VORAX       = 175,
    NYZUL_BUBURIMBOO            = 176,
    NYZUL_DUNE_WIDOW            = 177,
    -- ??? Box          2286
    NYZUL_AIATAR                = 178,
    NYZUL_INTULO                = 179,
    NYZUL_FRIAR_RUSH            = 180,
    NYZUL_SABOTENDER_BAILARIN   = 181,
    NYZUL_ODQAN                 = 182,
    NYZUL_UNUT                  = 183,
    NYZUL_STRAY_MARY            = 184,
    NYZUL_JADED_JODY            = 185
}

function updateInstanceTime(instance, elapsed, texttable)
    local players = instance:getChars();
    local lastTimeUpdate = instance:getLastTimeUpdate();
    local remainingTimeLimit = (instance:getTimeLimit()) * 60 - (elapsed / 1000);
    local wipeTime = instance:getWipeTime();
    local message = 0;
    
    if (remainingTimeLimit < 0) then
        instance:fail();
        return;
    end
    
    if (wipeTime == 0) then
        local wipe = true;
        for i,v in pairs(players) do
            if v:getHP() ~= 0 then
                wipe = false;
                break;
            end
        end
        if (wipe) then
            for i,v in pairs(players) do
                v:messageSpecial(texttable.PARTY_FALLEN, 3);
            end
            instance:setWipeTime(elapsed);
        end
    else
        if (elapsed - wipeTime) / 1000 > 180 then
            instance:fail();
            return;
        else
            for i,v in pairs(players) do
                if v:getHP() ~= 0 then
                    instance:setWipeTime(0);
                    break;
                end
            end
        end
    end

    if (lastTimeUpdate == 0 and remainingTimeLimit < 600) then
        message = 600;
    elseif (lastTimeUpdate == 600 and remainingTimeLimit < 300) then
        message = 300;
    elseif (lastTimeUpdate == 300 and remainingTimeLimit < 60) then
        message = 60;
    elseif (lastTimeUpdate == 60 and remainingTimeLimit < 30) then
        message = 30;
    elseif (lastTimeUpdate == 30 and remainingTimeLimit < 10) then
        message = 10;
    end
    
    if (message ~= 0) then
        for i,v in pairs(players) do
            if (remainingTimeLimit >= 60) then
                v:messageSpecial(texttable.TIME_REMAINING_MINUTES, remainingTimeLimit / 60);
            else
                v:messageSpecial(texttable.TIME_REMAINING_SECONDS, remainingTimeLimit);
            end
        end
        instance:setLastTimeUpdate(message);
    end
end

function loadFloorByMobGroup(instance, group_start, group_end)
    --
    -- Examples:
    -- loadFloorByMobGroup(instance, Zhayolm.mob[1].MOBB_START, Zhayolm.mob[1].MOBB_END);
    -- loadFloorByMobGroup(instnace, Zhayolm.mob[6]);
    --
    if instance == nil then
        return
    end
    if group_start == nil then
        return
    end
    if group_end == nil then
        for _,id in ipairs(group_start) do
            SpawnMob(id, instance)
        end
    else
        for id = group_start, group_end do
            if DespawnTime < os.time() - 5 then
                SpawnMob(id, instance)
            end
        end
    end
end;

function unloadFloorByMobGroup(instance, group_start, group_end)
    --
    -- Examples:
    -- unloadFloorByMobGroup(instance, Zhayolm.mob[1].MOBB_START, Zhayolm.mob[1].MOBB_END);
    -- unloadFloorByMobGroup(instnace, Zhayolm.mob[6]);
    --
    if instance == nil then
        return
    end
    if group_start == nil then
        return
	end
    if group_end == nil then
        for _,id in ipairs(group_start) do
            DespawnMob(id, instance)
        end
    else
        for id = group_start, group_end do
            if DespawnTime < os.time() - 5 then
                DespawnMob(id, instance)
            end
        end
    end
end;

function allOnSameEventFloor(players, event)
    if event == nil then
        return
    end

    for _,p in ipairs(players) do
        local floorId = p:getLocalVar("Instance-FloorEventID")
        if event ~= floorId then
            return false
        end
    end
    return true
end;