cmake_minimum_required(VERSION 3.7)
project(darkstar)

add_definitions(
    -DdsUDPSERV
    -DDEBUGLOGMAP
)

add_executable(DSGame-server
    ../common/blowfish.cpp
    ../common/detour/DetourAlloc.cpp
    ../common/detour/DetourCommon.cpp
    ../common/detour/DetourNavMesh.cpp
    ../common/detour/DetourNavMeshBuilder.cpp
    ../common/detour/DetourNavMeshQuery.cpp
    ../common/detour/DetourNode.cpp
    ../common/kernel.cpp
    ../common/md52.cpp
    ../common/showmsg.cpp
    ../common/socket.cpp
    ../common/sql.cpp
    ../common/taskmgr.cpp
    ../common/timer.cpp
    ../common/utils.cpp
    ../common/zlib.cpp
    ability.cpp
    ai/ai_container.cpp
    ai/controllers/automaton_controller.cpp
    ai/controllers/mob_controller.cpp
    ai/controllers/controller.cpp
    ai/controllers/pet_controller.cpp
    ai/controllers/player_charm_controller.cpp
    ai/controllers/player_controller.cpp
    ai/helpers/action_queue.cpp
    ai/helpers/event_handler.cpp
    ai/helpers/pathfind.cpp
    ai/helpers/targetfind.cpp
    ai/states/ability_state.cpp
    ai/states/attack_state.cpp
    ai/states/respawn_state.cpp
    ai/states/death_state.cpp
    ai/states/inactive_state.cpp
    ai/states/item_state.cpp
    ai/states/magic_state.cpp
    ai/states/mobskill_state.cpp
    ai/states/raise_state.cpp
    ai/states/range_state.cpp
    ai/states/despawn_state.cpp
    ai/states/state.cpp
    ai/states/trigger_state.cpp
    ai/states/weaponskill_state.cpp
    alliance.cpp
    blue_spell.cpp
    blue_trait.cpp
    char_recast_container.cpp
    guild.cpp
    message.cpp
    commandhandler.cpp
    conquest_system.cpp
    enmity_container.cpp
    entities/automatonentity.cpp
    entities/baseentity.cpp
    entities/battleentity.cpp
    entities/charentity.cpp
    entities/mobentity.cpp
    entities/npcentity.cpp
    entities/petentity.cpp
    grades.cpp
    battlefield.cpp
    battlefield_handler.cpp
    instance.cpp
    instance_loader.cpp
    items/item.cpp
    items/item_armor.cpp
    items/item_currency.cpp
    items/item_fish.cpp
    items/item_furnishing.cpp
    items/item_general.cpp
    items/item_linkshell.cpp
    items/item_puppet.cpp
    items/item_shop.cpp
    items/item_usable.cpp
    items/item_weapon.cpp
    item_container.cpp
    latent_effect.cpp
    latent_effect_container.cpp
    linkshell.cpp
    lua/luautils.cpp
    lua/lua_ability.cpp
    lua/lua_action.cpp
    lua/lua_baseentity.cpp
    lua/lua_battlefield.cpp
    lua/lua_instance.cpp
    lua/lua_item.cpp
    lua/lua_mobskill.cpp
    lua/lua_region.cpp
    lua/lua_spell.cpp
    lua/lua_statuseffect.cpp
    lua/lua_trade_container.cpp
    lua/lua_zone.cpp
    map.cpp
    merit.cpp
    mobskill.cpp
    mob_spell_container.cpp
    mob_spell_list.cpp
    modifier.cpp
    navmesh.cpp
    packets/action.cpp
    packets/auction_house.cpp
    packets/bazaar_confirmation.cpp
    packets/bazaar_purchase.cpp
    packets/bazaar_check.cpp
    packets/bazaar_close.cpp
    packets/bazaar_item.cpp
    packets/bazaar_message.cpp
    packets/blacklist.cpp
    packets/campaing_map.cpp
    packets/caught_fish.cpp
    packets/char.cpp
    packets/char_abilities.cpp
    packets/char_appearance.cpp
    packets/char_check.cpp
    packets/char_emotion.cpp
    packets/char_equip.cpp
    packets/char_health.cpp
    packets/char_job_extra.cpp
    packets/char_jobs.cpp
    packets/char_recast.cpp
    packets/char_skills.cpp
    packets/char_spells.cpp
    packets/char_stats.cpp
    packets/char_sync.cpp
    packets/char_update.cpp
    packets/chat_message.cpp
    packets/chocobo_digging.cpp
    packets/change_music.cpp
    packets/conquest_map.cpp
    packets/cs_position.cpp
    packets/currency1.cpp
    packets/currency2.cpp
    packets/delivery_box.cpp
    packets/downloading_data.cpp
    packets/entity_update.cpp
    packets/event.cpp
    packets/event_string.cpp
    packets/event_update.cpp
    packets/entity_animation.cpp
    packets/event_update_string.cpp
    packets/fishing.cpp
    packets/guild_menu.cpp
    packets/guild_menu_buy.cpp
    packets/guild_menu_sell.cpp
    packets/guild_menu_buy_update.cpp
    packets/guild_menu_sell_update.cpp
    packets/instance_entry.cpp
    packets/inventory_assign.cpp
    packets/inventory_finish.cpp
    packets/inventory_item.cpp
    packets/inventory_modify.cpp
    packets/inventory_size.cpp
    packets/key_items.cpp
    packets/linkshell_message.cpp
    packets/linkshell_equip.cpp
    packets/lock_on.cpp
    packets/macroequipset.cpp
    packets/menu_config.cpp
    packets/menu_merit.cpp
    packets/menu_mog.cpp
    packets/menu_raisetractor.cpp
    packets/merit_points_categories.cpp
    packets/message_basic.cpp
    packets/message_debug.cpp
    packets/message_special.cpp
    packets/message_standard.cpp
    packets/message_system.cpp
    packets/message_text.cpp
    packets/party_effects.cpp
    packets/status_effects.cpp
    packets/synth_result.cpp
    packets/synth_suggestion.cpp
    packets/trade_action.cpp
    packets/trade_item.cpp
    packets/trade_request.cpp
    packets/trade_update.cpp
    packets/world_pass.cpp
    packets/party_define.cpp
    packets/party_invite.cpp
    packets/party_map.cpp
    packets/party_member_update.cpp
    packets/party_search.cpp
    packets/pet_sync.cpp
    packets/position.cpp
    packets/quest_mission_log.cpp
    packets/release.cpp
    packets/server_ip.cpp
    packets/server_message.cpp
    packets/shop_appraise.cpp
    packets/shop_buy.cpp
    packets/shop_items.cpp
    packets/shop_menu.cpp
    packets/stop_downloading.cpp
    packets/synth_animation.cpp
    packets/synth_message.cpp
    packets/treasure_find_item.cpp
    packets/treasure_lot_item.cpp
    packets/entity_visual.cpp
    packets/weather.cpp
    packets/wide_scan.cpp
    packets/wide_scan_track.cpp
    packets/zone_in.cpp
    packets/zone_visited.cpp
    packet_system.cpp
    party.cpp
    recast_container.cpp
    region.cpp
    spell.cpp
    status_effect.cpp
    status_effect_container.cpp
    time_server.cpp
    trade_container.cpp
    trait.cpp
    transport.cpp
    treasure_pool.cpp
    universal_container.cpp
    utils/attackutils.cpp
    utils/battleutils.cpp
    utils/blacklistutils.cpp
    utils/blueutils.cpp
    utils/charutils.cpp
    utils/fishingutils.cpp
    utils/guildutils.cpp
    utils/battlefieldutils.cpp
    utils/instanceutils.cpp
    utils/itemutils.cpp
    utils/jailutils.cpp
    utils/mobutils.cpp
    utils/petutils.cpp
    utils/puppetutils.cpp
    utils/synthutils.cpp
    utils/zoneutils.cpp
    vana_time.cpp
    weapon_skill.cpp
    zone.cpp
    attack.cpp
    attackround.cpp
    zone_entities.cpp
    zone_instance.cpp
)

if(UNIX)
    target_include_directories(DSGame-server PRIVATE
        ${MYSQLCLIENT_INCLUDE_DIRS}
        ${LUAJIT_INCLUDE_DIRS}
    )
    target_link_libraries(DSGame-server
        mysqlclient
        zmq
        pthread
        luajit-5.1
    )
else()
    target_include_directories(DSGame-server PRIVATE
        ../common
        ../../win32/external
        ../../win32/external/mysql
        ../../win32/external/zmq
    )

    target_link_libraries(DSGame-server
        libmariadb${lib_suffix}
        lua51${lib_spacer}${lib_suffix}
        libzmq${lib_debug}${lib_spacer}${lib_suffix}
        WS2_32
    )
endif()
